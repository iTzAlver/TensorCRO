# TensorCRO substrates.

This is a Tensorflow-based implementation of the Coral Reef Optimization algorithm. The algorithm is implemented as a Tensorflow graph, which allows to run it in GPU and TPU. The algorithm is implemented as a set of substrate layers that can be combined with other algorithms such as Differential Evolution, Harmony Search and Random Search. The framework also allows to implement crossover operators as blxalpha, gaussian, uniform, masked and multipoint.

Crossovers:
1. [BLXAlpha](#blxalpha)
2. [Gaussian](#gaussian)
3. [Uniform](#uniform)
4. [Masked](#masked)
5. [Multipoint](#multipoint)

Algorithms:
1. [Differential Evolution](#differential)
2. [Harmony Search](#harmony)
3. [Random Search](#random)

Mutations:
1. [Gaussian](#gaussian)
2. [Uniform](#uniform)
3. [Poisson](#poisson)
4. [Truncated Uniform](#truncated)
5. [Gamma](#gamma)

# Crossovers:

## BLXAlpha <a name="blxalpha"></a>

The BLXAlphaCrossover method implements the BLX-Alpha crossover method. This method is a
generalization of the BLX crossover method, which is a generalization of the SBX crossover
method. The BLX-Alpha crossover method is a linear combination of the parents, with a
random alpha value between 0 and 1.
- :directives: Specifications of the parameters.
- :scale: Scale of the alpha value.

## Gaussian <a name="gaussian"></a>

The GaussianCrossover method implements a gaussian crossover. It is a selector between two parents,
where the probability of selecting a parent is given by a gaussian distribution. If the mean is 0.5 it is
equivalent to a uniform crossover.
- :mean: Mean of the gaussian.
- :stddev: Standard deviation of the gaussian.

## Uniform <a name="uniform"></a>

Uniform crossover is a genetic operator used to combine the information of two parents to generate a new
individual. The new individual is generated by randomly selecting a gene from each parent with equal
probability. This operator is used in the genetic algorithm to generate new individuals. It takes no
arguments.

## Masked <a name="masked"></a>

The MaskedCrossover method implements a mask for the crossover method. The mask is a list of 0s and 1s, where
0s indicate that the corresponding gene will be taken from the father, and 1s indicate that the corresponding
gene will be taken from the mother.
- :mask: Mask for the crossover method.

## Multipoint <a name="multipoint"></a>

The MultipointCrossover class implements a multipoint crossover. The points is a list of indices where
the points between the parents are swapped. The mask is applied to each parent, so the offspring will be
composed of the points of the first parent in the positions indicated by the mask, and the points of the
second parent in the positions not indicated by the mask.
- :points: List of indices where the points between the parents are swapped.

# Algorithms:

## Differential Evolution <a name="differential"></a>

Differential Search Crossover Operator implements the Differential Evolution algorithm. It is a crossover
operator that uses the following formula:

    x_i^{(k+1)} = x_i^{(k)} + F \cdot (x_{r_1}^{(k)} - x_{r_2}^{(k)}) \cdot \mathbb{1}_{\{r < CR\}}

Where :math:`F` is the band-width, :math:`CR` is the crossover probability and :math:`r` is a random
number between 0 and 1. The :math:`\mathbb{1}_{\{r < CR\}}` is a binary mask that is 1 if :math:`r < CR`
and 0 otherwise.

- :directives: Parameter specifications.
- :crossover_probability: Crossover probability of the algorithm (CR).
- :band_width: Band-width of the algorithm (F).

## Harmony Search <a name="harmony"></a>

Harmony Search Crossover Operator implements the Harmony Search algorithm. It is a crossover operator that uses
the following formula:


    x_i^{(k+1)} =

        x_i^{(k)}  if r_1 < HMC_{r}


        x_{r_2}^{(k)}  if r_1 >= HMC_{r} \text{ and } r_2 < PA_{r}


        x_i^{(k)} + BW \cdot (U_{min} - U_{max})  if  r_1 >= HMC_{r}  and  r_2 \geq PA_{r}

Where `BW` is the band-width, `HMC_{r}` is the Harmony Memory Consideration rate, `PA_{r}` is
the Pitch Adjustment rate and `r_1` and `r_2` are random numbers between 0 and 1.

- :directives: Parameter specifications.
- :hmc_r: The Harmony Memory Consideration rate (HMCR).
- :pa_r: The Pitch Adjustment rate (PAR).
- :bandwidth: The band-width (BW).

## Random Search <a name="random"></a>

This class implements the Random Search algorithm. It is a simple algorithm that generates random individuals
within the search space.
- :directives: Parameter specifications.
- :size: Size of the new population (float or int). If float, it is the percentage of the original
population and if int, it is the number of new individuals.

# Mutations:

## Gaussian <a name="gaussian"></a>

The GaussianMutation method implements a gaussian mutation. It is a mutation where the new value is
given by a gaussian distribution.

## Uniform <a name="uniform"></a>

The UniformMutation method implements a uniform mutation. It is a mutation where the new value is
given by a uniform distribution.

## Poisson <a name="poisson"></a>

The PoissonMutation method implements a poisson mutation. It is a mutation where the new value is
given by a poisson distribution.

## Truncated Uniform <a name="truncated"></a>

The TruncatedUniformMutation method implements a truncated uniform mutation. It is a mutation where the new
value is given by a truncated uniform distribution.

## Gamma <a name="gamma"></a>

The GammaMutation method implements a gamma mutation. It is a mutation where the new value is
given by a gamma distribution.

# References:

1. [Coral Reef Optimization](https://sci2s.ugr.es/sites/default/files/ficherosPublicaciones/2352_07744242.pdf)
2. [Differential Evolution](https://link.springer.com/article/10.1023/A:1008202821328)
3. [Harmony Search](https://www.researchgate.net/publication/314523255_Harmony_Search_Algorithm)
4. [Random Search](https://www.tandfonline.com/doi/abs/10.1080/01621459.1953.10501200)